{
  "policy_analysis_architecture": {
    "utilization_target": "95%",
    "orchestration_flow": {
      "description": "La solución se orquesta a través de la PolicyAnalysisPipeline, que inicializa un IndustrialPolicyProcessor encargado de coordinar los módulos PolicyContradictionDetector, TemporalLogicVerifier y BayesianConfidenceCalculator para alcanzar el 95% de utilización del código.",
      "components": [
        {
          "name": "PolicyAnalysisPipeline",
          "role": "Orquestadora principal del análisis de política.",
          "key_methods": [
            "__init__",
            "analyze_text"
          ]
        },
        {
          "name": "IndustrialPolicyProcessor",
          "role": "Procesador central que delega tareas críticas a detectores y verificadores especializados.",
          "key_methods": [
            "__init__",
            "process",
            "_load_questionnaire",
            "_compile_pattern_registry",
            "_build_point_patterns",
            "_match_patterns_in_sentences"
          ]
        },
        {
          "name": "PolicyContradictionDetector",
          "role": "Detector de contradicciones, inconsistencias y conflictos numéricos, temporales y semánticos.",
          "key_methods": [
            "__init__",
            "_initialize_pdm_patterns",
            "_extract_quantitative_claims",
            "_parse_number",
            "_extract_resource_mentions",
            "_detect_numerical_inconsistencies",
            "_detect_resource_conflicts",
            "_determine_semantic_role",
            "_calculate_graph_fragmentation",
            "_detect_temporal_conflicts",
            "_calculate_confidence_interval",
            "_determine_relation_type",
            "_classify_contradiction",
            "_get_graph_statistics",
            "_calculate_global_semantic_coherence",
            "_build_knowledge_graph",
            "_get_dependency_depth",
            "_calculate_objective_alignment",
            "_extract_temporal_markers",
            "_calculate_contradiction_entropy",
            "_identify_affected_sections",
            "_generate_embeddings",
            "_identify_dependencies",
            "_calculate_syntactic_complexity",
            "_detect_logical_incompatibilities",
            "_generate_resolution_recommendations",
            "_get_context_window"
          ]
        },
        {
          "name": "TemporalLogicVerifier",
          "role": "Verificador especializado en consistencia temporal y cronogramas.",
          "key_methods": [
            "verify_temporal_consistency",
            "_build_timeline",
            "_check_deadline_constraints",
            "_classify_temporal_type",
            "_extract_resources"
          ]
        },
        {
          "name": "BayesianConfidenceCalculator",
          "role": "Calculadora bayesiana para ponderar la confianza de la evidencia.",
          "key_methods": [
            "calculate_posterior"
          ]
        },
        {
          "name": "SemanticAnalyzer",
          "role": "Analizador semántico basado en la MunicipalOntology para evaluar complejidad, temas transversales y roles semánticos.",
          "key_methods": [
            "init",
            "_calculate_semantic_complexity",
            "_classify_cross_cutting_themes"
          ]
        },
        {
          "name": "MunicipalOntology",
          "role": "Ontología central del dominio municipal.",
          "key_methods": [
            "init"
          ]
        },
        {
          "name": "DocumentProcessor",
          "role": "Cargador de documentos PDF y DOCX.",
          "key_methods": [
            "load_pdf",
            "load_docx"
          ]
        },
        {
          "name": "PDETMunicipalPlanAnalyzer",
          "role": "Analizador avanzado de planes PDET municipales, tabulados y generador de recomendaciones.",
          "key_methods": [
            "analyze_municipal_plan",
            "generate_recommendations"
          ]
        },
        {
          "name": "PerformanceAnalyzer",
          "role": "Motor para calcular la pérdida operacional y métricas de desempeño.",
          "key_methods": [
            {
              "name": "analyze_loss_function",
              "description": "Función implícita utilizada para cuantificar la desproporción meta-problema."
            }
          ]
        },
        {
          "name": "QualityScore",
          "role": "Dataclass para encapsular resultados de validación.",
          "key_methods": [
            "__init__"
          ]
        },
        {
          "name": "AdvancedDAGValidator",
          "role": "Validador estructural avanzado para teorías de cambio.",
          "key_methods": [
            "validacion_completa",
            "_validar_orden_causal",
            "_encontrar_caminos_completos"
          ]
        }
      ],
      "supporting_assets": [
        {
          "question_bank": 300
        },
        {
          "questionnaire_source": "questionnaire.json"
        },
        {
          "ontology_source": "MunicipalOntology"
        },
        {
          "models": {
            "transformers": "Cargados por PolicyContradictionDetector",
            "spacy": "es_core_news_lg"
          }
        }
      ]
    },
    "phase_0_inicializacion_y_carga": {
      "scope": "Común a las 300 preguntas",
      "steps": [
        {
          "name": "Carga y Configuración",
          "actions": [
            {
              "create_policy_processor": "Inicializa ProcessorConfig para el flujo"
            },
            {
              "PolicyAnalysisPipeline.__init__": "Instancia IndustrialPolicyProcessor"
            },
            {
              "IndustrialPolicyProcessor.__init__": "Instancia procesador de texto y puntuador, luego invoca _load_questionnaire para cargar las 300 preguntas."
            },
            {
              "DocumentProcessor.load_pdf": "Carga texto bruto de documentos municipales"
            },
            {
              "DocumentProcessor.load_docx": "Alternativa para documentos DOCX"
            }
          ]
        },
        {
          "name": "Preparación Semántica y de Patrones",
          "actions": [
            {
              "MunicipalOntology.init": "Inicializa la ontología municipal central"
            },
            {
              "SemanticAnalyzer.init": "Prepara el analizador semántico con la ontología"
            },
            {
              "IndustrialPolicyProcessor._compile_pattern_registry": "Transforma la taxonomía de patrones de verificación en expresiones regulares optimizadas mediante compile_pattern."
            },
            {
              "IndustrialPolicyProcessor._build_point_patterns": "Optimiza patrones específicos"
            },
            {
              "PolicyContradictionDetector.init": "Inicializa modelos de transformers y spaCy (es_core_news_lg) y estructuras de contradicción."
            },
            {
              "PolicyContradictionDetector._initialize_pdm_patterns": "Carga patrones específicos para Planes de Desarrollo Municipales (PDMs)."
            }
          ]
        }
      ]
    },
    "dimensiones": [
      {
        "id": "D1",
        "nombre": "Diagnóstico y Consistencia Inicial",
        "preguntas": "Q1 a Q5",
        "objetivo": "Verificar líneas base, brechas, suficiencia de recursos y capacidad institucional.",
        "subdimension": [
          {
            "pregunta": "D1-Q1",
            "tema": "Líneas Base",
            "cadena_metodos": [
              {
                "IndustrialPolicyProcessor.process": "Segmenta el texto con segment_into_sentences"
              },
              {
                "PolicyContradictionDetector._extract_quantitative_claims": "Busca patrones numéricos y cuantificaciones de brechas (\\d+%.*población.*sin)."
              },
              {
                "IndustrialPolicyProcessor._match_patterns_in_sentences": "Busca patrones de fuentes oficiales (DANE, DNP, etc.)."
              },
              {
                "PolicyContradictionDetector._parse_number": "Normaliza cifras extraídas"
              },
              {
                "SemanticAnalyzer._calculate_semantic_complexity": "Evalúa complejidad sintáctica como proxy de seriedad diagnóstica."
              },
              {
                "BayesianConfidenceCalculator.calculate_posterior": "Calcula confianza de la evidencia frente a la probabilidad previa de validez."
              }
            ]
          },
          {
            "pregunta": "D1-Q3",
            "tema": "Asignación de Recursos",
            "cadena_metodos": [
              {
                "PolicyContradictionDetector._extract_resource_mentions": "Extrae montos en COP, millones y sus asignaciones."
              },
              {
                "PolicyContradictionDetector._detect_numerical_inconsistencies": "Usa _are_comparable_claims y _calculate_numerical_divergence para contrastar recursos identificados con costos estimados o brechas diagnosticadas."
              },
              {
                "PolicyContradictionDetector._detect_resource_conflicts": "Verifica conflictos con el presupuesto total mediante _are_conflicting_allocations."
              }
            ]
          },
          {
            "pregunta": "D1-Q4",
            "tema": "Capacidad Institucional",
            "cadena_metodos": [
              {
                "IndustrialPolicyProcessor._match_patterns_in_sentences": "Identifica talento humano, procesos, gobernanza y cuellos de botella."
              },
              {
                "PolicyContradictionDetector._determine_semantic_role": "Clasifica si la oración describe capacidad existente o necesidad."
              },
              {
                "PolicyContradictionDetector._calculate_graph_fragmentation": "Mide fragmentación del grafo de actores para detectar coordinación."
              }
            ]
          },
          {
            "pregunta": "D1-Q5",
            "tema": "Marco Legal y Restricciones",
            "cadena_metodos": [
              {
                "IndustrialPolicyProcessor._match_patterns_in_sentences": "Busca leyes, decretos y restricciones presupuestales o temporales."
              },
              {
                "PolicyContradictionDetector._detect_temporal_conflicts": "Usa TemporalLogicVerifier.verify_temporal_consistency para validar plazos."
              },
              {
                "PolicyContradictionDetector._calculate_confidence_interval": "Aplica intervalo de confianza del 95% al score de coherencia."
              }
            ]
          }
        ]
      },
      {
        "id": "D2",
        "nombre": "Diseño de Actividades y Coherencia de Intervención",
        "preguntas": "Q1 a Q5",
        "objetivo": "Evaluar estructura formal de actividades, mecanismos causales y coherencia interna.",
        "subdimension": [
          {
            "pregunta": "D2-Q1",
            "tema": "Formato Estructurado",
            "cadena_metodos": [
              {
                "PDETMunicipalPlanAnalyzer.analyze_municipal_plan": "Detecta tablas estructuradas representadas como ExtractedTable."
              },
              {
                "IndustrialPolicyProcessor._match_patterns_in_sentences": "Busca elementos de formalización (tabla, cuadro, columna costo, BPIN)."
              },
              {
                "PolicyContradictionDetector._detect_temporal_conflicts": "Garantiza trazabilidad de cronogramas usando TemporalLogicVerifier._build_timeline."
              }
            ]
          },
          {
            "pregunta": "D2-Q2_Q3",
            "tema": "Especificidad y Causa Raíz",
            "cadena_metodos": [
              {
                "IndustrialPolicyProcessor._match_patterns_in_sentences": "Detecta instrumento, mecanismo causal y población objetivo."
              },
              {
                "PolicyContradictionDetector._determine_relation_type": "Relaciona actividades con diagnóstico (D1) buscando patrones causales."
              },
              {
                "SemanticAnalyzer._classify_cross_cutting_themes": "Confirma correspondencia temática (ej. género) con el área política."
              }
            ]
          },
          {
            "pregunta": "D2-Q4",
            "tema": "Riesgos y Mitigación",
            "cadena_metodos": [
              {
                "IndustrialPolicyProcessor._match_patterns_in_sentences": "Identifica conflictos entre actividades y medidas de mitigación."
              },
              {
                "PolicyContradictionDetector._detect_logical_incompatibilities": "Usa _has_logical_conflict para hallar incompatibilidades lógicas."
              },
              {
                "PolicyContradictionDetector._identify_affected_sections": "Señala secciones del plan impactadas por el riesgo detectado."
              }
            ]
          },
          {
            "pregunta": "D2-Q5",
            "tema": "Coherencia Estratégica",
            "cadena_metodos": [
              {
                "PolicyContradictionDetector._calculate_global_semantic_coherence": "Mide coherencia global mediante embeddings y _text_similarity."
              },
              {
                "PolicyContradictionDetector._build_knowledge_graph": "Construye grafo de dependencias para visualizar complementariedades y secuencias."
              },
              {
                "PolicyContradictionDetector._get_dependency_depth": "Evalúa complejidad de la estructura relacional."
              }
            ]
          }
        ]
      },
      {
        "id": "D3",
        "nombre": "Productos y Factibilidad Operativa",
        "preguntas": "Q1 a Q5",
        "objetivo": "Verificar que los productos sean medibles, trazables, proporcionales y factibles.",
        "subdimension": [
          {
            "pregunta": "D3-Q1",
            "tema": "Indicadores de Producto",
            "cadena_metodos": [
              {
                "PolicyContradictionDetector._extract_quantitative_claims": "Extrae valores numéricos de Línea Base y Meta."
              },
              {
                "IndustrialPolicyProcessor._match_patterns_in_sentences": "Busca fuente de verificación y trazabilidad presupuestal (BPIN, PPI)."
              },
              {
                "BayesianConfidenceCalculator.calculate_posterior": "Asigna puntaje de confianza basado en la especificidad de la fuente."
              }
            ]
          },
          {
            "pregunta": "D3-Q2",
            "tema": "Proporcionalidad Meta/Problema",
            "cadena_metodos": [
              {
                "PolicyContradictionDetector._detect_numerical_inconsistencies": "Compara meta del producto con déficit o brecha de D1 usando pruebas de significancia."
              },
              {
                "PerformanceAnalyzer.analyze_loss_function": "Inyecta función de pérdida operacional que penaliza desproporcionalidades."
              }
            ]
          },
          {
            "pregunta": "D3-Q4",
            "tema": "Factibilidad Técnica",
            "cadena_metodos": [
              {
                "PolicyContradictionDetector._detect_temporal_conflicts": "Usa TemporalLogicVerifier._check_deadline_constraints y _classify_temporal_type para validar plazos."
              },
              {
                "PolicyContradictionDetector._detect_resource_conflicts": "Verifica suficiencia de recursos para alcanzar la meta."
              },
              {
                "PolicyContradictionDetector._get_context_window": "Recupera contexto para informes de factibilidad o contradicción."
              }
            ]
          },
          {
            "pregunta": "D3-Q5",
            "tema": "Mecanismo Producto -> Resultado",
            "cadena_metodos": [
              {
                "IndustrialPolicyProcessor._match_patterns_in_sentences": "Identifica mecanismos causales y mediadores."
              },
              {
                "PolicyContradictionDetector._determine_relation_type": "Clasifica fuerza de la relación causal entre producto y resultado."
              }
            ]
          }
        ]
      },
      {
        "id": "D4",
        "nombre": "Resultados, Supuestos y Alineación",
        "preguntas": "Q1 a Q5",
        "objetivo": "Evaluar calidad de indicadores de resultado, cadena causal y coherencia externa.",
        "subdimension": [
          {
            "pregunta": "D4-Q2",
            "tema": "Cadena Causal y Supuestos",
            "cadena_metodos": [
              {
                "IndustrialPolicyProcessor._match_patterns_in_sentences": "Identifica supuestos, condiciones habilitantes y cláusulas \"si... entonces\"."
              },
              {
                "PolicyContradictionDetector._build_knowledge_graph": "Conecta Producto->Resultado, marcando supuestos como aristas críticas."
              },
              {
                "PolicyContradictionDetector._determine_semantic_role": "Asegura que las oraciones cumplan rol de supuesto o condición."
              }
            ]
          },
          {
            "pregunta": "D4-Q3",
            "tema": "Justificación de Ambición",
            "cadena_metodos": [
              {
                "PolicyContradictionDetector._detect_numerical_inconsistencies": "Revisa coherencia entre inversión (D1-Q3) y meta ambiciosa."
              },
              {
                "PolicyContradictionDetector._calculate_objective_alignment": "Contrasta ambición con objetivos superiores o benchmarks."
              },
              {
                "PDETMunicipalPlanAnalyzer.generate_recommendations": "Sugiere mejoras cuando la validación falla."
              }
            ]
          },
          {
            "pregunta": "D4-Q5",
            "tema": "Alineación Externa",
            "cadena_metodos": [
              {
                "IndustrialPolicyProcessor._match_patterns_in_sentences": "Busca menciones a PND, ODS y Acuerdo de Paz."
              },
              {
                "PolicyContradictionDetector._calculate_global_semantic_coherence": "Mide coherencia entre plan y marcos normativos usando PolicyDimension."
              }
            ]
          }
        ]
      },
      {
        "id": "D5",
        "nombre": "Impactos y Riesgos Sistémicos",
        "preguntas": "Q1 a Q5",
        "objetivo": "Evaluar visión de largo plazo, medición de intangibles y vulnerabilidad a choques externos.",
        "subdimension": [
          {
            "pregunta": "D5-Q1",
            "tema": "Definición y Rezagos",
            "cadena_metodos": [
              {
                "PolicyContradictionDetector._extract_temporal_markers": "Identifica tiempos de maduración y rezago."
              },
              {
                "TemporalLogicVerifier._extract_resources": "Reutilizado para reconocer factores de transmisión clave."
              },
              {
                "PolicyContradictionDetector._calculate_objective_alignment": "Evalúa alineación del impacto con la visión estratégica."
              }
            ]
          },
          {
            "pregunta": "D5-Q2_Q3",
            "tema": "Medición de Intangibles",
            "cadena_metodos": [
              {
                "IndustrialPolicyProcessor._match_patterns_in_sentences": "Busca índice, proxy, medición indirecta y limitaciones."
              },
              {
                "PolicyContradictionDetector._classify_contradiction": "Pondera probabilidad de afirmaciones engañosas sobre proxies."
              },
              {
                "PolicyContradictionDetector._get_graph_statistics": "Mide densidad de conexiones del nodo de impacto."
              }
            ]
          },
          {
            "pregunta": "D5-Q4",
            "tema": "Riesgos Sistémicos",
            "cadena_metodos": [
              {
                "IndustrialPolicyProcessor._match_patterns_in_sentences": "Identifica riesgos sistémicos, rupturas de mecanismos y vulnerabilidades."
              },
              {
                "PolicyContradictionDetector._detect_logical_incompatibilities": "Verifica incompatibilidades entre estrategia y riesgos."
              },
              {
                "PolicyContradictionDetector._calculate_contradiction_entropy": "Calcula entropía de riesgos/contradicciones para evaluar cobertura."
              }
            ]
          },
          {
            "pregunta": "D5-Q5",
            "tema": "Realismo y Efectos No Deseados",
            "cadena_metodos": [
              {
                "IndustrialPolicyProcessor._match_patterns_in_sentences": "Busca efectos no deseados, hipótesis límite y trade-offs."
              },
              {
                "CounterfactualScenario": "Contrasta escenario ideal con escenarios alternativos para detectar efectos."
              }
            ]
          }
        ]
      },
      {
        "id": "D6",
        "nombre": "Coherencia Causal (Teoría de Cambio)",
        "preguntas": "Q1 a Q5",
        "objetivo": "Integrar análisis causal utilizando PolicyContradictionDetector y AdvancedDAGValidator.",
        "subdimension": [
          {
            "pregunta": "D6-Q1_Q2",
            "tema": "Estructura de la Causalidad",
            "cadena_metodos": [
              {
                "PolicyContradictionDetector._build_knowledge_graph": "Genera un nx.DiGraph de PolicyStatement."
              },
              {
                "AdvancedDAGValidator.validacion_completa": "Orquesta la validación estructural del grafo."
              },
              {
                "AdvancedDAGValidator._validar_orden_causal": "Detecta violaciones de orden causal."
              },
              {
                "AdvancedDAGValidator._encontrar_caminos_completos": "Garantiza ruta Causa->Actividad->Producto->Resultado->Impacto."
              },
              {
                "IndustrialPolicyProcessor._match_patterns_in_sentences": "Confirma ausencia de saltos y proporcionalidad."
              },
              {
                "PolicyContradictionDetector._calculate_syntactic_complexity": "Evalúa claridad de la teoría de cambio."
              }
            ]
          },
          {
            "pregunta": "D6-Q3_Q4",
            "tema": "Inconsistencias y Adaptación",
            "cadena_metodos": [
              {
                "PolicyContradictionDetector._detect_logical_incompatibilities": "Identifica incoherencias estructurales."
              },
              {
                "IndustrialPolicyProcessor._match_patterns_in_sentences": "Busca piloto, pruebas, mecanismos de corrección y aprendizaje."
              },
              {
                "PolicyContradictionDetector._generate_resolution_recommendations": "Utiliza _suggest_resolutions específicas por tipo de contradicción."
              }
            ]
          },
          {
            "pregunta": "D6-Q5",
            "tema": "Contextualización y Enfoque Diferencial",
            "cadena_metodos": [
              {
                "PolicyContradictionDetector._generate_embeddings": "Compara declaraciones con embeddings canónicos de vulnerabilidad."
              },
              {
                "SemanticAnalyzer._classify_cross_cutting_themes": "Verifica correspondencia con temas transversales relevantes."
              },
              {
                "PolicyContradictionDetector._identify_dependencies": "Detecta dependencias respecto a variables contextuales o diferenciales."
              }
            ]
          }
        ]
      }
    ],
    "modulos_transversales_y_rendimiento": {
      "objetivos": "Garantizar la integración de métricas de rendimiento y metaanálisis para alcanzar el 95% de utilización de funciones.",
      "requisitos": [
        {
          "PerformanceAnalyzer": "Debe instanciarse para calcular pérdida operacional"
        },
        {
          "PolicyContradictionDetector._calculate_global_semantic_coherence": "Uso constante"
        },
        {
          "PolicyContradictionDetector._calculate_objective_alignment": "Uso constante"
        },
        {
          "QualityScore": "Encapsula resultados de validación"
        }
      ],
      "gestion_resultados_y_reporte": {
        "consolidacion": {
          "metodo": "_construct_evidence_bundle",
          "descripcion": "Serializa la evidencia encontrada tras el análisis"
        },
        "resumen_ejecutivo": {
          "responsable": "MunicipalAnalyzer._generate_summary",
          "insumos": [
            "semantic_cube",
            "performance_analysis (PerformanceAnalyzer)",
            "critical_diagnosis (PolicyContradictionDetector)"
          ],
          "descripcion": "Genera un informe final integrando evidencia, análisis semántico y hallazgos críticos."
        }
      }
    }
  }
}